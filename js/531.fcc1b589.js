"use strict";(self["webpackChunkblog_system"]=self["webpackChunkblog_system"]||[]).push([[531],{3531:function(e,a,l){l.r(a),l.d(a,{default:function(){return f}});var t=l(6768),r=l(4232),o=l(5130);const u={class:"article-publish-container"},s={class:"page-title"},i=["src"],n={class:"editor-container"};function c(e,a,l,c,g,d){const m=(0,t.g2)("el-input"),p=(0,t.g2)("el-form-item"),v=(0,t.g2)("el-option"),b=(0,t.g2)("el-select"),k=(0,t.g2)("el-tag"),f=(0,t.g2)("el-button"),y=(0,t.g2)("Plus"),F=(0,t.g2)("el-icon"),h=(0,t.g2)("el-upload"),_=(0,t.g2)("el-form");return(0,t.uX)(),(0,t.CE)("div",u,[(0,t.Lk)("h1",s,(0,r.v_)(c.isEdit?"编辑文章":"发布新文章"),1),(0,t.bF)(_,{model:c.articleForm,rules:c.rules,ref:"articleFormRef","label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{label:"文章标题",prop:"title"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:c.articleForm.title,"onUpdate:modelValue":a[0]||(a[0]=e=>c.articleForm.title=e),placeholder:"请输入文章标题"},null,8,["modelValue"])])),_:1}),(0,t.bF)(p,{label:"文章分类",prop:"category"},{default:(0,t.k6)((()=>[(0,t.bF)(b,{modelValue:c.articleForm.category,"onUpdate:modelValue":a[1]||(a[1]=e=>c.articleForm.category=e),placeholder:"请选择文章分类"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(c.categories,(e=>((0,t.uX)(),(0,t.Wv)(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(p,{label:"文章标签"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(c.articleForm.tags,(e=>((0,t.uX)(),(0,t.Wv)(k,{key:e,closable:"",onClose:a=>c.removeTag(e),class:"article-tag"},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(e),1)])),_:2},1032,["onClose"])))),128)),c.tagInputVisible?((0,t.uX)(),(0,t.Wv)(m,{key:0,ref:"tagInputRef",modelValue:c.tagInputValue,"onUpdate:modelValue":a[2]||(a[2]=e=>c.tagInputValue=e),class:"tag-input",size:"small",onKeyup:(0,o.jR)(c.addTag,["enter"]),onBlur:c.addTag},null,8,["modelValue","onKeyup","onBlur"])):((0,t.uX)(),(0,t.Wv)(f,{key:1,size:"small",onClick:c.showTagInput},{default:(0,t.k6)((()=>a[5]||(a[5]=[(0,t.eW)("+ 添加标签")]))),_:1,__:[5]},8,["onClick"]))])),_:1}),(0,t.bF)(p,{label:"封面图片",prop:"coverImage"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{class:"cover-uploader",action:"#","http-request":c.uploadCover,"show-file-list":!1,"before-upload":c.beforeCoverUpload},{default:(0,t.k6)((()=>[c.articleForm.coverImage?((0,t.uX)(),(0,t.CE)("img",{key:0,src:c.articleForm.coverImage,class:"cover-image"},null,8,i)):((0,t.uX)(),(0,t.Wv)(F,{key:1,class:"cover-uploader-icon"},{default:(0,t.k6)((()=>[(0,t.bF)(y)])),_:1}))])),_:1},8,["http-request","before-upload"]),a[6]||(a[6]=(0,t.Lk)("div",{class:"upload-tip"},"建议尺寸: 900x500px，支持jpg、png格式",-1))])),_:1,__:[6]}),(0,t.bF)(p,{label:"文章摘要",prop:"summary"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:c.articleForm.summary,"onUpdate:modelValue":a[3]||(a[3]=e=>c.articleForm.summary=e),type:"textarea",rows:3,placeholder:"请输入文章摘要，不超过200字",maxlength:"200","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,t.bF)(p,{label:"文章内容",prop:"content"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",n,[(0,t.bF)(m,{modelValue:c.articleForm.content,"onUpdate:modelValue":a[4]||(a[4]=e=>c.articleForm.content=e),type:"textarea",rows:15,placeholder:"请输入文章内容..."},null,8,["modelValue"])])])),_:1}),(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.bF)(f,{onClick:c.saveAsDraft,loading:c.savingDraft},{default:(0,t.k6)((()=>a[7]||(a[7]=[(0,t.eW)("保存草稿")]))),_:1,__:[7]},8,["onClick","loading"]),(0,t.bF)(f,{type:"primary",onClick:c.publishArticle,loading:c.publishing},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(c.isEdit?"更新文章":"发布文章"),1)])),_:1},8,["onClick","loading"])])),_:1})])),_:1},8,["model","rules"])])}l(4114),l(8111),l(2489);var g=l(144),d=l(1387),m=l(1219),p=l(7477),v={name:"ArticlePublishView",components:{Plus:p.FWt},setup(){const e=(0,d.lq)(),a=(0,d.rd)(),l=(0,g.KR)(null),r=(0,g.KR)(null),o=(0,g.KR)(!1),u=(0,g.KR)(""),s=(0,g.KR)(!1),i=(0,g.KR)(!1),n=(0,t.EW)((()=>!!e.params.id)),c=(0,g.Kh)({title:"",category:"",tags:[],coverImage:"",summary:"",content:""}),p={title:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:5,max:100,message:"标题长度在5到100个字符之间",trigger:"blur"}],category:[{required:!0,message:"请选择文章分类",trigger:"change"}],coverImage:[{required:!0,message:"请上传文章封面图片",trigger:"change"}],summary:[{required:!0,message:"请输入文章摘要",trigger:"blur"},{max:200,message:"摘要不能超过200个字符",trigger:"blur"}],content:[{required:!0,message:"请输入文章内容",trigger:"blur"},{min:100,message:"文章内容不能少于100个字符",trigger:"blur"}]},v=[{id:"1",name:"技术"},{id:"2",name:"生活"},{id:"3",name:"随笔"},{id:"4",name:"教程"}],b=async()=>{if(!n.value)return;e.params.id;try{setTimeout((()=>{const e={title:"如何使用Vue 3构建高性能Web应用",category:"1",tags:["Vue","JavaScript","前端开发"],coverImage:"https://picsum.photos/id/1/900/500",summary:"Vue 3带来了许多令人兴奋的新特性，本文将详细介绍如何利用这些特性构建高性能的Web应用。",content:"这是文章的详细内容..."};Object.assign(c,e)}),500)}catch(a){m.nk.error("获取文章数据失败")}},k=()=>{o.value=!0,(0,t.dY)((()=>{r.value.focus()}))},f=()=>{const e=u.value.trim();e&&(c.tags.includes(e)?m.nk.warning("标签已存在"):c.tags.length>=5?m.nk.warning("最多添加5个标签"):c.tags.push(e)),o.value=!1,u.value=""},y=e=>{c.tags=c.tags.filter((a=>a!==e))},F=e=>{const a="image/jpeg"===e.type,l="image/png"===e.type,t=e.size/1024/1024<2;return a||l?!!t||(m.nk.error("封面图片大小不能超过2MB!"),!1):(m.nk.error("封面图片只能是JPG或PNG格式!"),!1)},h=e=>{const a=e.file,l=new FileReader;l.readAsDataURL(a),l.onload=()=>{c.coverImage=l.result}},_=async()=>{s.value=!0;try{setTimeout((()=>{m.nk.success("草稿保存成功"),s.value=!1}),1e3)}catch(e){m.nk.error("保存草稿失败"),s.value=!1}},V=async()=>{l.value.validate((async e=>{if(e){i.value=!0;try{setTimeout((()=>{m.nk.success(n.value?"文章更新成功":"文章发布成功"),i.value=!1,a.push("/my-articles")}),1500)}catch(l){m.nk.error(n.value?"更新文章失败":"发布文章失败"),i.value=!1}}else m.nk.warning("请完善文章信息")}))};return(0,t.sV)((()=>{b()})),{articleFormRef:l,articleForm:c,rules:p,categories:v,isEdit:n,tagInputRef:r,tagInputVisible:o,tagInputValue:u,savingDraft:s,publishing:i,showTagInput:k,addTag:f,removeTag:y,beforeCoverUpload:F,uploadCover:h,saveAsDraft:_,publishArticle:V}}},b=l(1241);const k=(0,b.A)(v,[["render",c],["__scopeId","data-v-512410a6"]]);var f=k}}]);
//# sourceMappingURL=531.fcc1b589.js.map